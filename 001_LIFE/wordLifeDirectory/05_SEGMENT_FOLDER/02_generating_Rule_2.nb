(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     58020,       1548]
NotebookOptionsPosition[     55798,       1501]
NotebookOutlinePosition[     56143,       1516]
CellTagsIndexPosition[     56100,       1513]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   StyleBox["Clear",
    FontSize->12], "[", 
   RowBox[{
   "i", ",", "j", ",", "g", ",", "out1", ",", "out2", ",", "out3", ",", 
    "out4", ",", "out5", ",", "out6", ",", "blueTerm1", ",", "blueTerm2"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"neighs", "=", 
    RowBox[{"{", 
     RowBox[{
     "xNW", ",", "xN", ",", "xNE", ",", "xW", ",", "xE", ",", "xSW", ",", 
      "xS", ",", "xSE"}], "}"}]}], ";"}],
  FontSize->12], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"nays", "=", 
     RowBox[{"{", 
      RowBox[{"Nothing", "\[IndentingNewLine]", "\t", ",", 
       RowBox[{"x", "[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", 
         RowBox[{"j", "-", "1"}], ",", "g"}], "]"}], "\[IndentingNewLine]", 
       "\t", ",", 
       RowBox[{"x", "[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", "j", ",", "g"}], "]"}], 
       "\[IndentingNewLine]", "\t", ",", 
       RowBox[{"x", "[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", 
         RowBox[{"j", "+", "1"}], ",", "g"}], "]"}], "\[IndentingNewLine]", 
       "\t", ",", 
       RowBox[{"x", "[", 
        RowBox[{"i", ",", 
         RowBox[{"j", "-", "1"}], ",", "g"}], "]"}], "\[IndentingNewLine]", 
       "  ", "  ", "  ", "  ", " ", ",", 
       RowBox[{"x", "[", 
        RowBox[{"i", ",", 
         RowBox[{"j", "+", "1"}], ",", "g"}], "]"}], "\[IndentingNewLine]", 
       "  ", "  ", "  ", "  ", " ", ",", 
       RowBox[{"x", "[", 
        RowBox[{
         RowBox[{"i", "+", "1"}], ",", 
         RowBox[{"j", "-", "1"}], ",", "g"}], "]"}], "\[IndentingNewLine]", 
       "\t", ",", 
       RowBox[{"x", "[", 
        RowBox[{
         RowBox[{"i", "+", "1"}], ",", "j", ",", "g"}], " ", "]"}], 
       "\[IndentingNewLine]", "  ", "  ", "  ", "  ", " ", ",", 
       RowBox[{"x", "[", 
        RowBox[{
         RowBox[{"i", "+", "1"}], ",", 
         RowBox[{"j", "+", "1"}], ",", "g"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}],
   FontSize->12], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules0", "=", 
   RowBox[{"Thread", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"nays", "\[Rule]", "#"}], "&"}], "/@", 
      RowBox[{"Permutations", "[", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "}"}], "]"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules1", "=", 
   RowBox[{"Thread", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"nays", "\[Rule]", "#"}], "&"}], "/@", 
      RowBox[{"Permutations", "[", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "1"}], "}"}], "]"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules2", "=", 
   RowBox[{"Thread", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"nays", "\[Rule]", "#"}], "&"}], "/@", 
      RowBox[{"Permutations", "[", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
         "1"}], "}"}], "]"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules3", "=", 
   RowBox[{"Thread", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"nays", "\[Rule]", "#"}], "&"}], "/@", 
      RowBox[{"Permutations", "[", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", 
         "1"}], "}"}], "]"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules4", "=", 
   RowBox[{"Thread", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"nays", "\[Rule]", "#"}], "&"}], "/@", 
      RowBox[{"Permutations", "[", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", 
         "1"}], "}"}], "]"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules5", "=", 
   RowBox[{"Thread", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"nays", "\[Rule]", "#"}], "&"}], "/@", 
      RowBox[{"Permutations", "[", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
         "1"}], "}"}], "]"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules6", "=", 
   RowBox[{"Thread", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"nays", "\[Rule]", "#"}], "&"}], "/@", 
      RowBox[{"Permutations", "[", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
         "1"}], "}"}], "]"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules7", "=", 
   RowBox[{"Thread", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"nays", "\[Rule]", "#"}], "&"}], "/@", 
      RowBox[{"Permutations", "[", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
         "1"}], "}"}], "]"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules8", "=", 
   RowBox[{"Thread", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"nays", "\[Rule]", "#"}], "&"}], "/@", 
      RowBox[{"Permutations", "[", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
         "1"}], "}"}], "]"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out1", "=", 
   RowBox[{"{", 
    RowBox[{
    "Nothing", "\[IndentingNewLine]", ",", "rules0", "\[IndentingNewLine]", 
     ",", "rules1", "\[IndentingNewLine]", ",", "rules2", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{",", "rules3"}], "*)"}], "\[IndentingNewLine]", ",", "rules4", 
     "\[IndentingNewLine]", ",", "rules5", "\[IndentingNewLine]", ",", 
     "rules6", "\[IndentingNewLine]", ",", "rules7", "\[IndentingNewLine]", 
     ",", "rules8"}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out2", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"out1", " ", ",", "1"}], "]"}]}], "\[IndentingNewLine]"}], "Input",\

 CellFrame->{{True, True}, {False, True}},
 TaggingRules->{"LastCursorPosition" -> False},
 CellFrameLabels->{{None, None}, {None, "input (mathematica code)"}},
 CellChangeTimes->{{3.765690460663842*^9, 3.765690461391439*^9}, {
  3.7656906024434443`*^9, 3.765690603751608*^9}, {3.795254185438952*^9, 
  3.795254228396311*^9}, {3.7952666219911747`*^9, 3.795266790750103*^9}, {
  3.7952669497246313`*^9, 3.7952669640147877`*^9}, {3.7952670324247723`*^9, 
  3.7952671356987953`*^9}, {3.79526716609468*^9, 3.7952672071984863`*^9}, {
  3.795267374848174*^9, 3.795267402316243*^9}, {3.795271356151827*^9, 
  3.795271368800009*^9}},
 Background->GrayLevel[0.95],
 CellLabel->"In[27]:=",ExpressionUUID->"ce5e8be6-4b19-4890-8c15-06587145a703"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "+", "i"}], ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "j"}], ",", "g"}], "]"}], "\[Rule]",
               "0"}], ",", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "+", "i"}], ",", "j", ",", "g"}], "]"}], 
              "\[Rule]", "0"}], ",", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "+", "i"}], ",", 
                RowBox[{"1", "+", "j"}], ",", "g"}], "]"}], "\[Rule]", "0"}], 
             ",", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "j"}], ",", "g"}], "]"}], "\[Rule]",
               "0"}], ",", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"i", ",", 
                RowBox[{"1", "+", "j"}], ",", "g"}], "]"}], "\[Rule]", "0"}], 
             ",", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{"1", "+", "i"}], ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "j"}], ",", "g"}], "]"}], "\[Rule]",
               "0"}], ",", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{"1", "+", "i"}], ",", "j", ",", "g"}], "]"}], 
              "\[Rule]", "0"}], ",", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{"1", "+", "i"}], ",", 
                RowBox[{"1", "+", "j"}], ",", "g"}], "]"}], "\[Rule]", 
              "0"}]}], "}"}], ",", 
           TemplateBox[{"198"},
            "OutputSizeLimit`Skeleton"], ",", 
           RowBox[{"{", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton"], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{117., {4., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLText",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{104., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 40, 20378912441584590806, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{117., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 40, 20378912441584590806, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{88., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 40, 20378912441584590806, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{159., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[20378912441584590806 === $SessionID, 
   Out[40], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellFrame->{{True, True}, {True, False}},
 CellFrameLabels->{{None, None}, {"output", None}},
 CellChangeTimes->{{3.765690460729289*^9, 3.765690463079056*^9}, {
   3.765690604830686*^9, 3.7656906091543818`*^9}, 3.795254185461426*^9, 
   3.795254228831997*^9, {3.7952669570175657`*^9, 3.79526696436353*^9}, {
   3.795267141326353*^9, 3.795267207887664*^9}, {3.795267380349641*^9, 
   3.7952674031827374`*^9}, 3.795268235495613*^9, 3.7952713263790083`*^9, 
   3.7952713879858093`*^9},
 Background->GrayLevel[0.85],
 CellLabel->"Out[40]=",ExpressionUUID->"8062bbf9-2b81-4691-9ef1-0dc7232a64ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out3", "=", 
  RowBox[{"rules1", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellFrame->{{True, True}, {False, True}},
 TaggingRules->{"LastCursorPosition" -> False},
 CellFrameLabels->{{None, None}, {None, "input (mathematica code)"}},
 CellChangeTimes->{{3.765690460663842*^9, 3.765690461391439*^9}, {
  3.7656906024434443`*^9, 3.765690603751608*^9}, {3.795267221225534*^9, 
  3.795267246315213*^9}, {3.795267311202838*^9, 3.795267312183679*^9}, {
  3.7952673785175123`*^9, 3.7952673785717363`*^9}},
 Background->GrayLevel[0.95],
 CellLabel->"In[41]:=",ExpressionUUID->"0b05d583-16a0-40d8-a3da-b432fc281a62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "+", "i"}], ",", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "j"}], ",", "g"}], "]"}], "\[Rule]", 
  "0"}]], "Output",
 CellFrame->{{True, True}, {True, False}},
 CellFrameLabels->{{None, None}, {"output", None}},
 CellChangeTimes->{{3.765690460729289*^9, 3.765690463079056*^9}, {
   3.765690604830686*^9, 3.7656906091543818`*^9}, {3.795267221256248*^9, 
   3.795267246594709*^9}, 3.795267314162696*^9, 3.795267383370946*^9, 
   3.7952682355875263`*^9, 3.795271326524818*^9, 3.795271388080496*^9},
 Background->GrayLevel[0.85],
 CellLabel->"Out[41]=",ExpressionUUID->"1bc202c8-c3d9-4be2-8235-1df63e78b9ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   StyleBox["Clear",
    FontSize->12], "[", "translate", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["translate",
     FontSize->12], "[", 
    RowBox[{"Rule", "[", 
     RowBox[{"expr_", " ", ",", "state_"}], "]"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"state", "\[Equal]", "0"}], ",", 
     RowBox[{"!", "expr"}], ",", "expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"translate", "[", "out3", "]"}]}], "Input",
 CellFrame->{{True, True}, {False, True}},
 TaggingRules->{"LastCursorPosition" -> False},
 CellFrameLabels->{{None, None}, {None, "input (mathematica code)"}},
 CellChangeTimes->{{3.765690460663842*^9, 3.765690461391439*^9}, {
  3.7656906024434443`*^9, 3.765690603751608*^9}, {3.795267250085842*^9, 
  3.795267324277894*^9}, {3.7952674726636887`*^9, 3.79526748464507*^9}},
 Background->GrayLevel[0.95],
 CellLabel->"In[42]:=",ExpressionUUID->"2cee6c79-6372-47d6-a824-1e372971a3fb"],

Cell[BoxData[
 RowBox[{"!", 
  RowBox[{"x", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "+", "i"}], ",", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "j"}], ",", "g"}], "]"}]}]], "Output",
 CellFrame->{{True, True}, {True, False}},
 CellFrameLabels->{{None, None}, {"output", None}},
 CellChangeTimes->{{3.765690460729289*^9, 3.765690463079056*^9}, {
   3.765690604830686*^9, 3.7656906091543818`*^9}, 3.7952672501084423`*^9, 
   3.795267325859757*^9, {3.795267467732677*^9, 3.795267484915572*^9}, 
   3.7952682356274233`*^9, 3.795271326567843*^9, 3.795271388103541*^9},
 Background->GrayLevel[0.85],
 CellLabel->"Out[44]=",ExpressionUUID->"80b1ebb7-cb1f-44ec-a93c-564a618b3868"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out4", "=", 
  RowBox[{"Map", "[", 
   RowBox[{"translate", ",", "out2", " ", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input",
 CellFrame->{{True, True}, {False, True}},
 TaggingRules->{"LastCursorPosition" -> False},
 CellFrameLabels->{{None, None}, {None, "input (mathematica code)"}},
 CellChangeTimes->{{3.765690460663842*^9, 3.765690461391439*^9}, {
  3.7656906024434443`*^9, 3.765690603751608*^9}, {3.795267389206855*^9, 
  3.7952675200992804`*^9}, {3.795267590994372*^9, 3.795267594727566*^9}},
 Background->GrayLevel[0.95],
 CellLabel->"In[45]:=",ExpressionUUID->"62ed71d3-de2d-4952-9a88-76939b6615f7"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "+", "i"}], ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "j"}], ",", "g"}], "]"}]}], ",", 
             RowBox[{"!", 
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "+", "i"}], ",", "j", ",", "g"}], 
               "]"}]}], ",", 
             RowBox[{"!", 
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "+", "i"}], ",", 
                RowBox[{"1", "+", "j"}], ",", "g"}], "]"}]}], ",", 
             RowBox[{"!", 
              RowBox[{"x", "[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "j"}], ",", "g"}], "]"}]}], ",", 
             RowBox[{"!", 
              RowBox[{"x", "[", 
               RowBox[{"i", ",", 
                RowBox[{"1", "+", "j"}], ",", "g"}], "]"}]}], ",", 
             RowBox[{"!", 
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{"1", "+", "i"}], ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "j"}], ",", "g"}], "]"}]}], ",", 
             RowBox[{"!", 
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{"1", "+", "i"}], ",", "j", ",", "g"}], "]"}]}], ",", 
             RowBox[{"!", 
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{"1", "+", "i"}], ",", 
                RowBox[{"1", "+", "j"}], ",", "g"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton"], "}"}], ",", 
           TemplateBox[{"197"},
            "OutputSizeLimit`Skeleton"], ",", 
           RowBox[{"{", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton"], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{117., {4., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLText",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{104., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 45, 20378912441584590806, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{117., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 45, 20378912441584590806, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{88., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 45, 20378912441584590806, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{159., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[20378912441584590806 === $SessionID, 
   Out[45], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellFrame->{{True, True}, {True, False}},
 CellFrameLabels->{{None, None}, {"output", None}},
 CellChangeTimes->{{3.765690460729289*^9, 3.765690463079056*^9}, {
   3.765690604830686*^9, 3.7656906091543818`*^9}, {3.795267389232975*^9, 
   3.795267416118115*^9}, {3.795267458318619*^9, 3.795267520506585*^9}, 
   3.795267595079043*^9, 3.795268235696209*^9, 3.795271326638912*^9, 
   3.7952713881501207`*^9},
 Background->GrayLevel[0.85],
 CellLabel->"Out[45]=",ExpressionUUID->"37f5a7ce-e098-471c-b571-66ecdb01a438"]
}, Open  ]],

Cell[TextData[StyleBox["ok, so now we have result 2.9",
 StripOnInput->False,
 LineColor->RGBColor[1, 0, 1],
 FrontFaceColor->RGBColor[1, 0, 1],
 BackFaceColor->RGBColor[1, 0, 1],
 GraphicsColor->RGBColor[1, 0, 1],
 FontWeight->Normal,
 FontColor->RGBColor[1, 0, 1]]], "Title",
 Evaluatable->True,
 CellGroupingRules->"InputGroupin",
 CellEvaluationFunction->cel`gTalker,
 ShowCellLabel->False,
 CellFrameLabels->{{None, ""}, {None, None}},
 CellChangeTimes->{{3.795267566982041*^9, 3.7952675760083303`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"41886f48-f402-4107-b851-4f3e0bb2c04e"],

Cell[TextData[StyleBox["next we need to negate all of these.",
 StripOnInput->False,
 LineColor->RGBColor[
  0.22899251821568467`, 0.7568250097244553, 0.18772375680879838`],
 FrontFaceColor->RGBColor[
  0.22899251821568467`, 0.7568250097244553, 0.18772375680879838`],
 BackFaceColor->RGBColor[
  0.22899251821568467`, 0.7568250097244553, 0.18772375680879838`],
 GraphicsColor->RGBColor[
  0.22899251821568467`, 0.7568250097244553, 0.18772375680879838`],
 FontWeight->Normal,
 FontColor->RGBColor[
  0.22899251821568467`, 0.7568250097244553, 0.18772375680879838`]]], "Text",
 Evaluatable->True,
 CellGroupingRules->"InputGroupin",
 CellEvaluationFunction->cel`gTalker,
 ShowCellLabel->"False",
 CellFrameLabels->{{None, ""}, {None, None}},
 CellChangeTimes->{{3.795267582185523*^9, 3.79526758826367*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"cd7de38c-32b4-4e2a-ac3d-ac377a670ebf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox["out5",
   FontSize->12], 
  StyleBox["=",
   FontSize->12], 
  RowBox[{
   StyleBox["Map",
    FontSize->12], "[", 
   RowBox[{"Not", ",", "out4", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input",
 CellFrame->{{True, True}, {False, True}},
 TaggingRules->{"LastCursorPosition" -> False},
 CellFrameLabels->{{None, None}, {None, "input (mathematica code)"}},
 CellChangeTimes->{{3.765690460663842*^9, 3.765690461391439*^9}, {
  3.7656906024434443`*^9, 3.765690603751608*^9}, {3.7952675971510572`*^9, 
  3.795267617293984*^9}, {3.795267724729333*^9, 3.7952677254714746`*^9}},
 Background->GrayLevel[0.95],
 CellLabel->"In[48]:=",ExpressionUUID->"f8cee059-5530-41b6-afae-6d80931483ef"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "i"}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "j"}], ",", "g"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "i"}], ",", "j", ",", "g"}], "]"}], 
             ",", 
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "i"}], ",", 
               RowBox[{"1", "+", "j"}], ",", "g"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "j"}], ",", "g"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{"i", ",", 
               RowBox[{"1", "+", "j"}], ",", "g"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{"1", "+", "i"}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "j"}], ",", "g"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{"1", "+", "i"}], ",", "j", ",", "g"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{"1", "+", "i"}], ",", 
               RowBox[{"1", "+", "j"}], ",", "g"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton"], "}"}], ",", 
           TemplateBox[{"196"},
            "OutputSizeLimit`Skeleton"], ",", 
           RowBox[{"{", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton"], "}"}], ",", 
           RowBox[{"{", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton"], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{117., {4., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLText",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{104., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 48, 20378912441584590806, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{117., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 48, 20378912441584590806, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{88., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 48, 20378912441584590806, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{159., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[20378912441584590806 === $SessionID, 
   Out[48], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellFrame->{{True, True}, {True, False}},
 CellFrameLabels->{{None, None}, {"output", None}},
 CellChangeTimes->{{3.765690460729289*^9, 3.765690463079056*^9}, {
   3.765690604830686*^9, 3.7656906091543818`*^9}, {3.795267597158297*^9, 
   3.795267618511969*^9}, 3.795267727234696*^9, 3.795268235792444*^9, 
   3.7952713267136803`*^9, 3.795271388220873*^9},
 Background->GrayLevel[0.85],
 CellLabel->"Out[48]=",ExpressionUUID->"686b3796-7e4c-4bda-920c-9b640de8c0ec"]
}, Open  ]],

Cell[TextData[StyleBox["then we need to include the blue terms to formulate \
result 2.10",
 StripOnInput->False,
 LineColor->RGBColor[
  0.22899251821568467`, 0.7568250097244553, 0.18772375680879838`],
 FrontFaceColor->RGBColor[
  0.22899251821568467`, 0.7568250097244553, 0.18772375680879838`],
 BackFaceColor->RGBColor[
  0.22899251821568467`, 0.7568250097244553, 0.18772375680879838`],
 GraphicsColor->RGBColor[
  0.22899251821568467`, 0.7568250097244553, 0.18772375680879838`],
 FontWeight->Normal,
 FontColor->RGBColor[
  0.22899251821568467`, 0.7568250097244553, 
   0.18772375680879838`]]], "Subsection",
 Evaluatable->True,
 CellGroupingRules->"InputGroupin",
 CellEvaluationFunction->cel`gTalker,
 ShowCellLabel->False,
 CellFrameLabels->{{None, ""}, {None, None}},
 CellChangeTimes->{{3.7952676323319273`*^9, 3.795267648859972*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"5c6c625a-edab-421e-a28e-74758abda486"],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"blueTerm1", "=", 
    RowBox[{"x", "[", 
     RowBox[{"i", ",", "j", ",", "g"}], "]"}]}], ";"}],
  FontSize->12], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"blueTerm2", "=", 
    RowBox[{"!", 
     RowBox[{"x", "[", 
      RowBox[{"i", ",", "j", ",", 
       RowBox[{"g", "+", "1"}]}], "]"}]}]}], ";"}],
  FontSize->12], "\[IndentingNewLine]", 
 RowBox[{"out6", "=", 
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", "blueTerm1", "}"}], "~", "Join", "~", "#", "~", "Join", 
       "~", 
       RowBox[{"{", "blueTerm2", "}"}]}], ")"}], "&"}], "/@", "out5"}],
   FontSize->12]}]}], "Input",
 CellFrame->{{True, True}, {False, True}},
 TaggingRules->{"LastCursorPosition" -> False},
 CellFrameLabels->{{None, None}, {None, "input (mathematica code)"}},
 CellChangeTimes->{{3.765690460663842*^9, 3.765690461391439*^9}, {
   3.7656906024434443`*^9, 3.765690603751608*^9}, 3.7952676512393436`*^9, {
   3.795267700154561*^9, 3.795267791083987*^9}, 3.795268223235944*^9, {
   3.795271377022344*^9, 3.795271378195537*^9}},
 Background->GrayLevel[0.95],
 CellLabel->"In[50]:=",ExpressionUUID->"1c129608-7311-49ba-a378-18e2652a117d"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"i", ",", "j", ",", "g"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "i"}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "j"}], ",", "g"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "i"}], ",", "j", ",", "g"}], "]"}], 
             ",", 
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "i"}], ",", 
               RowBox[{"1", "+", "j"}], ",", "g"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "j"}], ",", "g"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{"i", ",", 
               RowBox[{"1", "+", "j"}], ",", "g"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{"1", "+", "i"}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "j"}], ",", "g"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{"1", "+", "i"}], ",", "j", ",", "g"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{"1", "+", "i"}], ",", 
               RowBox[{"1", "+", "j"}], ",", "g"}], "]"}], ",", 
             RowBox[{"!", 
              RowBox[{"x", "[", 
               RowBox[{"i", ",", "j", ",", 
                RowBox[{"1", "+", "g"}]}], "]"}]}]}], "}"}], ",", 
           TemplateBox[{"198"},
            "OutputSizeLimit`Skeleton"], ",", 
           RowBox[{"{", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton"], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{117., {4., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLText",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{104., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 52, 20378912441584590806, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{117., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 52, 20378912441584590806, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{88., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 52, 20378912441584590806, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{159., {0., 15.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[20378912441584590806 === $SessionID, 
   Out[52], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellFrame->{{True, True}, {True, False}},
 CellFrameLabels->{{None, None}, {"output", None}},
 CellChangeTimes->{{3.765690460729289*^9, 3.765690463079056*^9}, {
   3.765690604830686*^9, 3.7656906091543818`*^9}, 3.795267651261174*^9, {
   3.795267763258327*^9, 3.795267791844297*^9}, {3.7952682316228333`*^9, 
   3.795268235852313*^9}, 3.7952713267665462`*^9, 3.795271388277323*^9},
 Background->GrayLevel[0.85],
 CellLabel->"Out[52]=",ExpressionUUID->"4aebd09a-6716-41fd-ad70-ec6b9d614598"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"CopyToClipboard", "[", "out6", "]"}]], "Input",
 CellFrame->{{True, True}, {False, True}},
 TaggingRules->{"LastCursorPosition" -> False},
 CellFrameLabels->{{None, None}, {None, "input (mathematica code)"}},
 CellChangeTimes->{{3.765690460663842*^9, 3.765690461391439*^9}, {
  3.7656906024434443`*^9, 3.765690603751608*^9}, {3.7952712071308193`*^9, 
  3.795271213187723*^9}},
 Background->GrayLevel[0.95],
 CellLabel->"In[53]:=",ExpressionUUID->"46bba81e-82f6-4c6f-ae8b-eec609a819a4"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.767869704382765*^9, {3.795271505690188*^9, 
   3.795271506395314*^9}},ExpressionUUID->"018260bd-a80a-4bc5-b1c0-\
9777cb963569"]
},
WindowSize->{1686, 1387},
WindowMargins->{{Automatic, 1}, {-28, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"DefaultModified2.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 7159, 205, 1629, "Input",ExpressionUUID->"ce5e8be6-4b19-4890-8c15-06587145a703"],
Cell[7742, 229, 9976, 263, 374, "Output",ExpressionUUID->"8062bbf9-2b81-4691-9ef1-0dc7232a64ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17755, 497, 669, 13, 132, "Input",ExpressionUUID->"0b05d583-16a0-40d8-a3da-b432fc281a62"],
Cell[18427, 512, 701, 16, 169, "Output",ExpressionUUID->"1bc202c8-c3d9-4be2-8235-1df63e78b9ea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19165, 533, 1012, 25, 221, "Input",ExpressionUUID->"2cee6c79-6372-47d6-a824-1e372971a3fb"],
Cell[20180, 560, 689, 15, 169, "Output",ExpressionUUID->"80b1ebb7-cb1f-44ec-a93c-564a618b3868"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20906, 580, 641, 12, 132, "Input",ExpressionUUID->"62ed71d3-de2d-4952-9a88-76939b6615f7"],
Cell[21550, 594, 9820, 258, 330, "Output",ExpressionUUID->"37f5a7ce-e098-471c-b571-66ecdb01a438"]
}, Open  ]],
Cell[31385, 855, 587, 14, 143, "Title",ExpressionUUID->"41886f48-f402-4107-b851-4f3e0bb2c04e",
 Evaluatable->True,
 CellGroupingRules->"InputGroupin"],
Cell[31975, 871, 882, 19, 69, "Text",ExpressionUUID->"cd7de38c-32b4-4e2a-ac3d-ac377a670ebf",
 Evaluatable->True,
 CellGroupingRules->"InputGroupin"],
Cell[CellGroupData[{
Cell[32882, 894, 724, 18, 132, "Input",ExpressionUUID->"f8cee059-5530-41b6-afae-6d80931483ef"],
Cell[33609, 914, 9613, 252, 374, "Output",ExpressionUUID->"686b3796-7e4c-4bda-920c-9b640de8c0ec"]
}, Open  ]],
Cell[43237, 1169, 922, 21, 109, "Subsection",ExpressionUUID->"5c6c625a-edab-421e-a28e-74758abda486",
 Evaluatable->True,
 CellGroupingRules->"InputGroupin"],
Cell[CellGroupData[{
Cell[44184, 1194, 1229, 33, 221, "Input",ExpressionUUID->"1c129608-7311-49ba-a378-18e2652a117d"],
Cell[45416, 1229, 9673, 252, 374, "Output",ExpressionUUID->"4aebd09a-6716-41fd-ad70-ec6b9d614598"]
}, Open  ]],
Cell[55104, 1484, 509, 9, 132, "Input",ExpressionUUID->"46bba81e-82f6-4c6f-ae8b-eec609a819a4"],
Cell[55616, 1495, 178, 4, 61, "Input",ExpressionUUID->"018260bd-a80a-4bc5-b1c0-9777cb963569"]
}
]
*)

